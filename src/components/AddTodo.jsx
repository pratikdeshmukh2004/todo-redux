import React, { useEffect, useState } from "react";
import { useDispatch, useSelector } from "react-redux";
import { addTodo, editTodo, updateTodo } from "../features/todo/todoSlice";

function AddTodo() {
  const [input, setInput] = useState("");
  const dispatch = useDispatch();
  const editing = useSelector((state) => state.editing);

  const handleSubmit = (e) => {
    e.preventDefault();
    if (editing) {
      const newTodo = {...editing}
      newTodo.text = input;
      dispatch(updateTodo(newTodo));
      dispatch(editTodo(null))
    } else {
      dispatch(addTodo(input));
    }
    setInput("");
  };

  useEffect(() => {
    if (editing) {
      setInput(editing.text);
    }
  }, [editing]);

  return (
    <form className="mt-5 w-full flex" onSubmit={handleSubmit}>
      <input
        className="border outline-none border-gray-400 p-2 text-lg rounded-lg w-10/12"
        type="text"
        value={input}
        onChange={(e) => setInput(e.target.value)}
        name="todo"
        placeholder="Enter text"
      />
      {editing ? (
        <button className="bg-rose-500 text-lg ml-3 px-6 py-2 font-bold text-white rounded-lg">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            x="0px"
            y="0px"
            width="20"
            height="20"
            viewBox="0 0 32 32"
            fill="white"
          >
            <path d="M 20.455078 4.7519531 C 19.347051 4.7757776 18.202062 5.0893295 17.111328 5.7636719 C 14.890526 7.1361011 12.838975 8.7495765 10.990234 10.566406 C 8.5649573 12.950567 6.8890333 15.898332 5.8632812 19.070312 A 1.0001 1.0001 0 0 0 5.6757812 19.724609 C 5.0803984 21.789935 4.6916746 23.920766 4.7421875 26.107422 C 4.7563305 26.730187 5.2715454 27.244697 5.8945312 27.257812 C 8.0805181 27.308113 10.210713 26.919488 12.275391 26.324219 A 1.0001 1.0001 0 0 0 12.929688 26.136719 C 16.101605 25.110844 19.048028 23.433772 21.431641 21.007812 C 23.249576 19.157965 24.862109 17.106227 26.234375 14.886719 C 28.032621 11.978096 27.264736 8.6944239 25.285156 6.7148438 C 24.295366 5.7250536 22.978936 5.0371209 21.546875 4.8222656 C 21.18886 4.7685518 20.82442 4.7440116 20.455078 4.7519531 z M 20.541016 6.7207031 C 20.796625 6.7147589 21.047429 6.732706 21.292969 6.7714844 C 22.275127 6.9265978 23.165509 7.4233213 23.871094 8.1289062 C 25.282264 9.5400762 25.858957 11.691561 24.533203 13.835938 C 24.461793 13.951431 24.355983 14.039771 24.283203 14.154297 C 22.809995 11.415367 20.586852 9.18791 17.851562 7.7089844 C 17.963773 7.6377404 18.050919 7.5347649 18.164062 7.4648438 C 18.968204 6.9676861 19.774189 6.7385358 20.541016 6.7207031 z M 16.125 9.0644531 C 19.138178 10.456945 21.544591 12.863417 22.929688 15.880859 C 21.993489 17.156927 21.112563 18.479338 20.005859 19.605469 C 18.042935 21.603265 15.661654 23.069064 13.082031 24.023438 C 12.548664 21.426565 10.573434 19.451336 7.9765625 18.917969 C 8.9306698 16.338659 10.395766 13.957421 12.392578 11.994141 C 13.520031 10.886148 14.846417 10.002092 16.125 9.0644531 z M 7.4335938 20.806641 C 9.3891799 21.132294 10.867706 22.61082 11.193359 24.566406 C 9.7647736 24.934212 8.3058475 25.156333 6.8105469 25.189453 C 6.8436669 23.694148 7.0658132 22.235277 7.4335938 20.806641 z"></path>
          </svg>
        </button>
      ) : (
        <button className="bg-rose-500 text-lg ml-3 px-6 py-2 font-bold text-white rounded-lg">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            x="0px"
            y="0px"
            width="30"
            height="30"
            viewBox="0 0 64 64"
            fill="white"
          >
            <path d="M 31 2 C 15.007813 2 2 15.011719 2 31 C 2 46.988281 15.007813 60 31 60 C 46.992188 60 60 46.988281 60 31 C 60 15.011719 46.992188 2 31 2 Z M 31 4 C 45.886719 4 58 16.113281 58 31 C 58 45.886719 45.886719 58 31 58 C 16.113281 58 4 45.886719 4 31 C 4 16.113281 16.113281 4 31 4 Z M 30.5625 8.007813 C 24.671875 8.125 18.964844 10.507813 14.738281 14.734375 C 5.769531 23.703125 5.769531 38.292969 14.738281 47.261719 C 14.933594 47.457031 15.1875 47.554688 15.445313 47.554688 C 15.703125 47.554688 15.957031 47.457031 16.152344 47.261719 C 16.542969 46.871094 16.542969 46.238281 16.152344 45.847656 C 7.964844 37.660156 7.960938 24.339844 16.152344 16.152344 C 20.898438 11.402344 27.699219 9.203125 34.339844 10.265625 C 34.882813 10.355469 35.394531 9.980469 35.484375 9.4375 C 35.570313 8.890625 35.199219 8.375 34.65625 8.289063 C 33.289063 8.070313 31.921875 7.976563 30.5625 8.007813 Z M 38.65625 9.382813 C 38.269531 9.402344 37.910156 9.648438 37.765625 10.035156 C 37.570313 10.554688 37.832031 11.128906 38.351563 11.324219 C 39.0625 11.585938 39.765625 11.894531 40.449219 12.238281 C 40.59375 12.3125 40.75 12.347656 40.902344 12.347656 C 41.265625 12.347656 41.617188 12.148438 41.796875 11.796875 C 42.042969 11.308594 41.84375 10.703125 41.351563 10.453125 C 40.601563 10.078125 39.828125 9.738281 39.050781 9.445313 C 38.921875 9.398438 38.789063 9.378906 38.65625 9.382813 Z M 44.433594 12.675781 C 44.179688 12.707031 43.9375 12.835938 43.765625 13.050781 C 43.425781 13.488281 43.5 14.113281 43.9375 14.453125 C 44.601563 14.976563 45.246094 15.546875 45.847656 16.152344 C 54.039063 24.339844 54.039063 37.660156 45.847656 45.847656 C 45.457031 46.242188 45.457031 46.871094 45.847656 47.265625 C 46.042969 47.457031 46.300781 47.558594 46.558594 47.558594 C 46.8125 47.558594 47.070313 47.457031 47.265625 47.265625 C 56.230469 38.296875 56.230469 23.703125 47.265625 14.734375 C 46.605469 14.078125 45.898438 13.449219 45.171875 12.878906 C 44.953125 12.710938 44.6875 12.644531 44.433594 12.675781 Z M 31 18 C 30.449219 18 30 18.445313 30 19 L 30 30 L 19 30 C 18.449219 30 18 30.445313 18 31 C 18 31.554688 18.449219 32 19 32 L 30 32 L 30 43 C 30 43.554688 30.449219 44 31 44 C 31.550781 44 32 43.554688 32 43 L 32 32 L 43 32 C 43.550781 32 44 31.554688 44 31 C 44 30.445313 43.550781 30 43 30 L 32 30 L 32 19 C 32 18.445313 31.550781 18 31 18 Z M 21.375 47.394531 C 20.984375 47.347656 20.589844 47.527344 20.386719 47.886719 L 19.386719 49.617188 C 19.109375 50.097656 19.269531 50.707031 19.75 50.984375 C 19.90625 51.074219 20.078125 51.117188 20.25 51.117188 C 20.59375 51.117188 20.929688 50.9375 21.113281 50.617188 L 22.113281 48.886719 C 22.390625 48.410156 22.230469 47.796875 21.75 47.519531 C 21.628906 47.453125 21.5 47.410156 21.375 47.394531 Z M 40.625 47.394531 C 40.5 47.410156 40.371094 47.453125 40.25 47.519531 C 39.769531 47.796875 39.609375 48.410156 39.886719 48.890625 L 40.886719 50.621094 C 41.070313 50.941406 41.40625 51.121094 41.75 51.121094 C 41.921875 51.121094 42.09375 51.074219 42.25 50.984375 C 42.730469 50.707031 42.890625 50.097656 42.613281 49.621094 L 41.613281 47.890625 C 41.410156 47.53125 41.015625 47.347656 40.625 47.394531 Z M 36.1875 49.34375 C 36.058594 49.324219 35.921875 49.332031 35.785156 49.371094 C 35.253906 49.511719 34.9375 50.0625 35.078125 50.59375 L 35.597656 52.527344 C 35.71875 52.972656 36.121094 53.265625 36.5625 53.265625 C 36.648438 53.265625 36.734375 53.257813 36.824219 53.234375 C 37.355469 53.089844 37.671875 52.542969 37.53125 52.011719 L 37.015625 50.078125 C 36.90625 49.675781 36.570313 49.398438 36.1875 49.34375 Z M 25.8125 49.34375 C 25.429688 49.398438 25.09375 49.675781 24.984375 50.078125 L 24.46875 52.011719 C 24.324219 52.542969 24.640625 53.089844 25.175781 53.234375 C 25.261719 53.257813 25.351563 53.265625 25.4375 53.265625 C 25.875 53.265625 26.28125 52.972656 26.402344 52.527344 L 26.917969 50.59375 C 27.0625 50.0625 26.746094 49.511719 26.214844 49.371094 C 26.078125 49.332031 25.941406 49.328125 25.8125 49.34375 Z M 31 50 C 30.449219 50 30 50.445313 30 51 L 30 53 C 30 53.554688 30.449219 54 31 54 C 31.550781 54 32 53.554688 32 53 L 32 51 C 32 50.445313 31.550781 50 31 50 Z"></path>
          </svg>
        </button>
      )}
    </form>
  );
}

export default AddTodo;
